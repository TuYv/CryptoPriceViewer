<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>加密货币价格查看器</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <!-- 主页面 -->
    <div id="mainPage" class="page active">
      <h1 data-i18n="appTitle">加密货币价格</h1>
      
      <!-- 搜索功能 -->
    <div class="search-section">
      <div class="search-input-container">
        <input type="text" id="searchInput" placeholder="搜索币种名称或代码..." class="search-input" data-i18n-placeholder="searchPlaceholder">
        <button id="searchButton" class="search-button" data-i18n="search">搜索</button>
      </div>
      <div id="resultList" class="result-list hidden">
        <div id="searchResults" class="search-results hidden"></div>
      </div>
    </div>
    
    <div class="crypto-list" id="cryptoList">
      <div id="loadingIndicator" class="loading" data-i18n="loading">加载中...</div>
      <div id="errorMessage" class="error" style="display: none;"></div>
      <div id="noDataMessage" class="no-data" style="display: none;" data-i18n="noData">没有数据可显示</div>
      <!-- 加密货币数据将在这里动态插入 -->
    </div>
    
    <div class="controls">
      <button id="refreshButton" data-i18n="refresh">刷新</button>
      <button id="settingsButton" data-i18n="settings">设置</button>
      <button id="feedbackButton" data-i18n="feedback">反馈</button>
    </div>
    
    <div id="feedbackPanel" class="feedback-panel hidden">
      <h2 data-i18n="feedbackTitle">用户反馈</h2>
      <div class="feedback-content">
        <div class="donation-tip" data-i18n="donationTip">如果这个工具对您有帮助，欢迎给我打赏支持一下！</div>
        <div class="qr-codes-section">
          <div class="qr-code-item">
            <img src="images/bnb-qr.png" alt="BNB Chain QR Code" class="qr-code-image">
          </div>
          <div class="qr-code-item">
            <img src="images/sol-qr.png" alt="Solana QR Code" class="qr-code-image">
          </div>
        </div>
        
        <div class="feedback-input">
          <textarea id="feedbackText" placeholder="请输入您的反馈意见..." data-i18n-placeholder="feedbackPlaceholder"></textarea>
          <div class="common-actions">
            <button id="sendFeedbackButton" data-i18n="sendFeedback">发送反馈</button>
            <button id="cancelFeedbackButton" data-i18n="cancel">取消</button>
          </div>
        </div>
      </div>
    </div>

    <div id="settingsPanel" class="settings-panel hidden">
      <h2 data-i18n="settingsTitle">设置</h2>
      <div class="settings-content">
        <div class="refresh-interval">
          <h3 data-i18n="refreshInterval">自动刷新间隔</h3>
          <select id="refreshInterval">
            <option value="0" data-i18n="refreshOff">关闭自动刷新</option>
            <option value="30" data-i18n="interval30s">30秒</option>
            <option value="60" data-i18n="interval1m">1分钟</option>
            <option value="300" data-i18n="interval5m">5分钟</option>
            <option value="600" data-i18n="interval10m">10分钟</option>
          </select>
        </div>
        <div class="currency-selection">
          <h3 data-i18n="currency">显示货币</h3>
          <select id="currencySelect">
            <option value="USD" data-i18n="currencyUSD">美元 (USD)</option>
            <option value="CNY" data-i18n="currencyCNY">人民币 (CNY)</option>
            <option value="EUR" data-i18n="currencyEUR">欧元 (EUR)</option>
          </select>
        </div>
        

        <div class="language-selection">
          <h3 data-i18n="language">语言</h3>
          <select id="languageSelect">
            <option value="en" selected>English</option>
            <option value="zh">中文</option>
            <option value="ja">日本語</option>
            <option value="ko">한국어</option>
          </select>
        </div>
        <div class="common-actions">
          <button id="saveSettingsButton" data-i18n="save">保存</button>
          <button id="cancelSettingsButton" data-i18n="cancel">取消</button>
        </div>
      </div>
    </div>
    
      <div class="footer">
        <p data-i18n="dataSource">数据来源: CoinGecko API</p>
        <p class="last-updated"><span data-i18n="lastUpdated">最后更新</span>: <span id="lastUpdated">-</span></p>
      </div>
    </div>

    <!-- 币种详情页面 -->
    <div id="coinDetailPage" class="page coin-detail-page">
      <div class="detail-header">
        <button id="backButton" class="back-button">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m12 19-7-7 7-7"/>
            <path d="m19 12H5"/>
          </svg>
          <span data-i18n="back">返回</span>
        </button>
        <div class="coin-header">
          <img id="coinDetailIcon" class="coin-detail-icon" src="" alt="">
          <div class="coin-title">
            <h2 id="coinDetailName">Bitcoin</h2>
            <span id="coinDetailSymbol" class="coin-symbol">BTC</span>
          </div>
        </div>
      </div>

      <div class="detail-content">
        <!-- 价格概览 -->
        <div class="price-overview">
          <div class="current-price">
            <span class="price-label" data-i18n="currentPrice">当前价格</span>
            <span id="coinDetailPrice" class="price-value">$0.00</span>
          </div>
          <div class="price-change">
            <span id="coinDetailChange24h" class="change-value">+0.00%</span>
            <span class="change-label" data-i18n="change24h">24h变化</span>
          </div>
        </div>

        <!-- 价格图表 -->
        <div class="chart-section">
          <div class="chart-period-selector">
            <button class="period-btn active" data-period="1">1D</button>
            <button class="period-btn" data-period="7">7D</button>
            <button class="period-btn" data-period="30">30D</button>
            <button class="period-btn" data-period="90">90D</button>
          </div>
          <div class="chart-container">
            <canvas id="priceChart" width="280" height="200"></canvas>
            <div id="chartLoading" class="chart-loading" data-i18n="loading">加载中...</div>
          </div>
        </div>

        <!-- 详细信息 -->
        <div class="coin-stats">
          <div class="stat-item">
            <span class="stat-label" data-i18n="marketCap">市值</span>
            <span id="coinMarketCap" class="stat-value">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label" data-i18n="volume24h">24h交易量</span>
            <span id="coinVolume24h" class="stat-value">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label" data-i18n="circulatingSupply">流通供应量</span>
            <span id="coinCirculatingSupply" class="stat-value">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label" data-i18n="totalSupply">总供应量</span>
            <span id="coinTotalSupply" class="stat-value">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label" data-i18n="allTimeHigh">历史最高</span>
            <span id="coinAllTimeHigh" class="stat-value">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label" data-i18n="allTimeLow">历史最低</span>
            <span id="coinAllTimeLow" class="stat-value">-</span>
          </div>
        </div>

        <!-- 相关新闻 -->
        <div class="news-section">
          <h3 data-i18n="relatedNews">相关新闻</h3>
          <div id="coinNews" class="news-list">
            <div class="news-loading" data-i18n="loading">加载新闻中...</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 图片放大弹窗 -->
    <div class="image-modal" id="imageModal">
      <button class="image-modal-close" id="imageModalClose">×</button>
      <div class="image-modal-content">
        <img id="modalImage" src="" alt="">
      </div>
    </div>
  </div>

  <!-- 移除了冗余的早期 .env 注入脚本，统一使用 js/lib/env.js 的 Env.load() -->
  <script type="module" src="js/popup.js"></script>
</body>
</html>